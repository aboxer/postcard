<html>
  <head>
    <title>Postcard Entry</title>
   <link rel="stylesheet" type="text/css" href="/static/style.css">

   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
   <script>
      var zip2town = [[1001, "Agawam"], [1002, "Amherst"], [1003, "Amherst"], [1004, "Amherst"], [1005, "Barre"], [1007, "Belchertown"], [1008, "Blandford"], [1009, "Bondsville"], [1010, "Brimfield"], [1011, "Chester"], [1012, "Chesterfield"], [1013, "Chicopee"], [1014, "Chicopee"], [1020, "Chicopee"], [1021, "Chicopee"], [1022, "Chicopee"], [1026, "Cummington"], [1027, "Easthampton"], [1028, "East Longmeadow"], [1029, "East Otis"], [1030, "Feeding Hills"], [1031, "Gilbertville"], [1032, "Goshen"], [1033, "Granby"], [1034, "Granville"], [1035, "Hadley"], [1036, "Hampden"], [1037, "Hardwick"], [1038, "Hatfield"], [1039, "Haydenville"], [1040, "Holyoke"], [1041, "Holyoke"], [1050, "Huntington"], [1053, "Leeds"], [1054, "Leverett"], [1056, "Ludlow"], [1057, "Monson"], [1059, "North Amherst"], [1060, "Northampton"], [1061, "Northampton"], [1062, "Florence"], [1063, "Northampton"], [1066, "North Hatfield"], [1068, "Oakham"], [1069, "Palmer"], [1070, "Plainfield"], [1071, "Russell"], [1072, "Shutesbury"], [1073, "Southampton"], [1074, "South Barre"], [1075, "South Hadley"], [1077, "Southwick"], [1079, "Thorndike"], [1080, "Three Rivers"], [1081, "Wales"], [1082, "Ware"], [1083, "Warren"], [1084, "West Chesterfield"], [1085, "Westfield"], [1086, "Westfield"], [1088, "West Hatfield"], [1089, "West Springfield"], [1090, "West Springfield"], [1092, "West Warren"], [1093, "Whately"], [1094, "Wheelwright"], [1095, "Wilbraham"], [1096, "Williamsburg"], [1097, "Woronoco"], [1098, "Worthington"], [1101, "Springfield"], [1102, "Springfield"], [1103, "Springfield"], [1104, "Springfield"], [1105, "Springfield"], [1106, "Longmeadow"], [1107, "Springfield"], [1108, "Springfield"], [1109, "Springfield"], [1111, "Springfield"], [1115, "Springfield"], [1116, "Longmeadow"], [1118, "Springfield"], [1119, "Springfield"], [1128, "Springfield"], [1129, "Springfield"], [1133, "Springfield"], [1138, "Springfield"], [1139, "Springfield"], [1144, "Springfield"], [1151, "Indian Orchard"], [1152, "Springfield"], [1195, "Springfield"], [1199, "Springfield"], [1201, "Pittsfield"], [1202, "Pittsfield"], [1203, "Pittsfield"], [1220, "Adams"], [1222, "Ashley Falls"], [1223, "Becket"], [1224, "Berkshire"], [1225, "Cheshire"], [1226, "Dalton"], [1227, "Dalton"], [1229, "Glendale"], [1230, "Great Barrington"], [1235, "Hinsdale"], [1236, "Housatonic"], [1237, "Lanesboro"], [1238, "Lee"], [1240, "Lenox"], [1242, "Lenox Dale"], [1243, "Middlefield"], [1244, "Mill River"], [1245, "Monterey"], [1247, "North Adams"], [1252, "North Egremont"], [1253, "Otis"], [1254, "Richmond"], [1255, "Sandisfield"], [1256, "Savoy"], [1257, "Sheffield"], [1258, "South Egremont"], [1259, "Southfield"], [1260, "South Lee"], [1262, "Stockbridge"], [1263, "Stockbridge"], [1264, "Tyringham"], [1266, "West Stockbridge"], [1267, "Williamstown"], [1270, "Windsor"], [1301, "Greenfield"], [1302, "Greenfield"], [1330, "Ashfield"], [1331, "Athol"], [1337, "Bernardston"], [1338, "Buckland"], [1339, "Charlemont"], [1340, "Colrain"], [1341, "Conway"], [1342, "Deerfield"], [1343, "Drury"], [1344, "Erving"], [1346, "Heath"], [1347, "Lake Pleasant"], [1349, "Millers Falls"], [1350, "Monroe Bridge"], [1351, "Montague"], [1354, "Gill"], [1355, "New Salem"], [1360, "Northfield"], [1364, "Orange"], [1366, "Petersham"], [1367, "Rowe"], [1368, "Royalston"], [1370, "Shelburne Falls"], [1373, "South Deerfield"], [1375, "Sunderland"], [1376, "Turners Falls"], [1378, "Warwick"], [1379, "Wendell"], [1380, "Wendell Depot"], [1420, "Fitchburg"], [1430, "Ashburnham"], [1431, "Ashby"], [1432, "Ayer"], [1434, "Devens"], [1436, "Baldwinville"], [1438, "East Templeton"], [1440, "Gardner"], [1441, "Westminster"], [1450, "Groton"], [1451, "Harvard"], [1452, "Hubbardston"], [1453, "Leominster"], [1460, "Littleton"], [1462, "Lunenburg"], [1463, "Pepperell"], [1464, "Shirley"], [1467, "Still River"], [1468, "Templeton"], [1469, "Townsend"], [1470, "Groton"], [1471, "Groton"], [1472, "West Groton"], [1473, "Westminster"], [1474, "West Townsend"], [1475, "Winchendon"], [1477, "Winchendon Springs"], [1501, "Auburn"], [1503, "Berlin"], [1504, "Blackstone"], [1505, "Boylston"], [1506, "Brookfield"], [1507, "Charlton"], [1508, "Charlton City"], [1509, "Charlton Depot"], [1510, "Clinton"], [1515, "East Brookfield"], [1516, "Douglas"], [1517, "East Princeton"], [1518, "Fiskdale"], [1519, "Grafton"], [1520, "Holden"], [1521, "Holland"], [1522, "Jefferson"], [1523, "Lancaster"], [1524, "Leicester"], [1525, "Linwood"], [1526, "Manchaug"], [1527, "Millbury"], [1529, "Millville"], [1531, "New Braintree"], [1532, "Northborough"], [1534, "Northbridge"], [1535, "North Brookfield"], [1536, "North Grafton"], [1537, "North Oxford"], [1538, "North Uxbridge"], [1540, "Oxford"], [1541, "Princeton"], [1542, "Rochdale"], [1543, "Rutland"], [1545, "Shrewsbury"], [1546, "Shrewsbury"], [1550, "Southbridge"], [1560, "South Grafton"], [1561, "South Lancaster"], [1562, "Spencer"], [1564, "Sterling"], [1566, "Sturbridge"], [1568, "Upton"], [1569, "Uxbridge"], [1570, "Webster"], [1571, "Dudley"], [1580, "Westborough"], [1581, "Westborough"], [1582, "Westborough"], [1583, "West Boylston"], [1585, "West Brookfield"], [1586, "West Millbury"], [1588, "Whitinsville"], [1590, "Sutton"], [1601, "Worcester"], [1602, "Worcester"], [1603, "Worcester"], [1604, "Worcester"], [1605, "Worcester"], [1606, "Worcester"], [1607, "Worcester"], [1608, "Worcester"], [1609, "Worcester"], [1610, "Worcester"], [1611, "Cherry Valley"], [1612, "Paxton"], [1613, "Worcester"], [1614, "Worcester"], [1615, "Worcester"], [1653, "Worcester"], [1654, "Worcester"], [1655, "Worcester"], [1701, "Framingham"], [1702, "Framingham"], [1703, "Framingham"], [1704, "Framingham"], [1705, "Framingham"], [1718, "Village Of Nagog Woods"], [1719, "Boxborough"], [1720, "Acton"], [1721, "Ashland"], [1730, "Bedford"], [1731, "Hanscom Afb"], [1740, "Bolton"], [1741, "Carlisle"], [1742, "Concord"], [1745, "Fayville"], [1746, "Holliston"], [1747, "Hopedale"], [1748, "Hopkinton"], [1749, "Hudson"], [1752, "Marlborough"], [1754, "Maynard"], [1756, "Mendon"], [1757, "Milford"], [1760, "Natick"], [1770, "Sherborn"], [1772, "Southborough"], [1773, "Lincoln"], [1775, "Stow"], [1776, "Sudbury"], [1778, "Wayland"], [1784, "Woodville"], [1801, "Woburn"], [1803, "Burlington"], [1805, "Burlington"], [1806, "Woburn"], [1807, "Woburn"], [1808, "Woburn"], [1810, "Andover"], [1812, "Andover"], [1813, "Woburn"], [1815, "Woburn"], [1821, "Billerica"], [1822, "Billerica"], [1824, "Chelmsford"], [1826, "Dracut"], [1827, "Dunstable"], [1830, "Haverhill"], [1831, "Haverhill"], [1832, "Haverhill"], [1833, "Georgetown"], [1834, "Groveland"], [1835, "Haverhill"], [1840, "Lawrence"], [1841, "Lawrence"], [1842, "Lawrence"], [1843, "Lawrence"], [1844, "Methuen"], [1845, "North Andover"], [1850, "Lowell"], [1851, "Lowell"], [1852, "Lowell"], [1853, "Lowell"], [1854, "Lowell"], [1860, "Merrimac"], [1862, "North Billerica"], [1863, "North Chelmsford"], [1864, "North Reading"], [1865, "Nutting Lake"], [1866, "Pinehurst"], [1867, "Reading"], [1876, "Tewksbury"], [1879, "Tyngsboro"], [1880, "Wakefield"], [1885, "West Boxford"], [1886, "Westford"], [1887, "Wilmington"], [1888, "Woburn"], [1889, "North Reading"], [1890, "Winchester"], [1899, "Andover"], [1901, "Lynn"], [1902, "Lynn"], [1903, "Lynn"], [1904, "Lynn"], [1905, "Lynn"], [1906, "Saugus"], [1907, "Swampscott"], [1908, "Nahant"], [1910, "Lynn"], [1913, "Amesbury"], [1915, "Beverly"], [1921, "Boxford"], [1922, "Byfield"], [1923, "Danvers"], [1929, "Essex"], [1930, "Gloucester"], [1931, "Gloucester"], [1936, "Hamilton"], [1937, "Hathorne"], [1938, "Ipswich"], [1940, "Lynnfield"], [1944, "Manchester"], [1945, "Marblehead"], [1949, "Middleton"], [1950, "Newburyport"], [1951, "Newbury"], [1952, "Salisbury"], [1960, "Peabody"], [1961, "Peabody"], [1965, "Prides Crossing"], [1966, "Rockport"], [1969, "Rowley"], [1970, "Salem"], [1971, "Salem"], [1982, "South Hamilton"], [1983, "Topsfield"], [1984, "Wenham"], [1985, "West Newbury"], [2018, "Accord"], [2019, "Bellingham"], [2020, "Brant Rock"], [2021, "Canton"], [2025, "Cohasset"], [2026, "Dedham"], [2027, "Dedham"], [2030, "Dover"], [2031, "East Mansfield"], [2032, "East Walpole"], [2035, "Foxboro"], [2038, "Franklin"], [2040, "Greenbush"], [2041, "Green Harbor"], [2043, "Hingham"], [2044, "Hingham"], [2045, "Hull"], [2047, "Humarock"], [2048, "Mansfield"], [2050, "Marshfield"], [2051, "Marshfield Hills"], [2052, "Medfield"], [2053, "Medway"], [2054, "Millis"], [2055, "Minot"], [2056, "Norfolk"], [2059, "North Marshfield"], [2060, "North Scituate"], [2061, "Norwell"], [2062, "Norwood"], [2065, "Ocean Bluff"], [2066, "Scituate"], [2067, "Sharon"], [2070, "Sheldonville"], [2071, "South Walpole"], [2072, "Stoughton"], [2081, "Walpole"], [2090, "Westwood"], [2093, "Wrentham"], [2108, "Boston"], [2109, "Boston"], [2110, "Boston"], [2111, "Boston"], [2112, "Boston"], [2113, "Boston"], [2114, "Boston"], [2115, "Boston"], [2116, "Boston"], [2117, "Boston"], [2118, "Boston"], [2119, "Boston"], [2120, "Boston"], [2121, "Boston"], [2122, "Boston"], [2123, "Boston"], [2124, "Boston"], [2125, "Boston"], [2126, "Mattapan"], [2127, "Boston"], [2128, "Boston"], [2129, "Charlestown"], [2130, "Jamaica Plain"], [2131, "Roslindale"], [2132, "West Roxbury"], [2133, "Boston"], [2134, "Allston"], [2135, "Brighton"], [2136, "Hyde Park"], [2137, "Readville"], [2138, "Cambridge"], [2139, "Cambridge"], [2140, "Cambridge"], [2141, "Cambridge"], [2142, "Cambridge"], [2143, "Somerville"], [2144, "Somerville"], [2145, "Somerville"], [2148, "Malden"], [2149, "Everett"], [2150, "Chelsea"], [2151, "Revere"], [2152, "Winthrop"], [2153, "Medford"], [2155, "Medford"], [2156, "West Medford"], [2163, "Boston"], [2169, "Quincy"], [2170, "Quincy"], [2171, "Quincy"], [2176, "Melrose"], [2180, "Stoneham"], [2184, "Braintree"], [2185, "Braintree"], [2186, "Milton"], [2187, "Milton Village"], [2188, "Weymouth"], [2189, "East Weymouth"], [2190, "South Weymouth"], [2191, "North Weymouth"], [2196, "Boston"], [2199, "Boston"], [2201, "Boston"], [2203, "Boston"], [2204, "Boston"], [2205, "Boston"], [2206, "Boston"], [2207, "Boston"], [2210, "Boston"], [2211, "Boston"], [2212, "Boston"], [2215, "Boston"], [2216, "Boston"], [2217, "Boston"], [2222, "Boston"], [2228, "East Boston"], [2238, "Cambridge"], [2239, "Cambridge"], [2241, "Boston"], [2266, "Boston"], [2269, "Quincy"], [2283, "Boston"], [2284, "Boston"], [2293, "Boston"], [2295, "Boston"], [2297, "Boston"], [2298, "Boston"], [2301, "Brockton"], [2302, "Brockton"], [2303, "Brockton"], [2304, "Brockton"], [2305, "Brockton"], [2322, "Avon"], [2324, "Bridgewater"], [2325, "Bridgewater"], [2327, "Bryantville"], [2330, "Carver"], [2331, "Duxbury"], [2332, "Duxbury"], [2333, "East Bridgewater"], [2334, "Easton"], [2337, "Elmwood"], [2338, "Halifax"], [2339, "Hanover"], [2340, "Hanover"], [2341, "Hanson"], [2343, "Holbrook"], [2344, "Middleboro"], [2345, "Manomet"], [2346, "Middleboro"], [2347, "Lakeville"], [2348, "Lakeville"], [2349, "Middleboro"], [2350, "Monponsett"], [2351, "Abington"], [2355, "North Carver"], [2356, "North Easton"], [2357, "North Easton"], [2358, "North Pembroke"], [2359, "Pembroke"], [2360, "Plymouth"], [2361, "Plymouth"], [2362, "Plymouth"], [2364, "Kingston"], [2366, "South Carver"], [2367, "Plympton"], [2368, "Randolph"], [2370, "Rockland"], [2375, "South Easton"], [2379, "West Bridgewater"], [2381, "White Horse Beach"], [2382, "Whitman"], [2420, "Lexington"], [2421, "Lexington"], [2445, "Brookline"], [2446, "Brookline"], [2447, "Brookline Village"], [2451, "Waltham"], [2452, "Waltham"], [2453, "Waltham"], [2454, "Waltham"], [2455, "North Waltham"], [2456, "New Town"], [2457, "Babson Park"], [2458, "Newton"], [2459, "Newton Center"], [2460, "Newtonville"], [2461, "Newton Highlands"], [2462, "Newton Lower Falls"], [2464, "Newton Upper Falls"], [2465, "West Newton"], [2466, "Auburndale"], [2467, "Chestnut Hill"], [2468, "Waban"], [2471, "Watertown"], [2472, "Watertown"], [2474, "Arlington"], [2475, "Arlington Heights"], [2476, "Arlington"], [2477, "Watertown"], [2478, "Belmont"], [2479, "Waverley"], [2481, "Wellesley Hills"], [2482, "Wellesley"], [2492, "Needham"], [2493, "Weston"], [2494, "Needham Heights"], [2495, "Nonantum"], [2532, "Buzzards Bay"], [2534, "Cataumet"], [2535, "Chilmark"], [2536, "East Falmouth"], [2537, "East Sandwich"], [2538, "East Wareham"], [2539, "Edgartown"], [2540, "Falmouth"], [2541, "Falmouth"], [2542, "Buzzards Bay"], [2543, "Woods Hole"], [2552, "Menemsha"], [2553, "Monument Beach"], [2554, "Nantucket"], [2556, "North Falmouth"], [2557, "Oak Bluffs"], [2558, "Onset"], [2559, "Pocasset"], [2561, "Sagamore"], [2562, "Sagamore Beach"], [2563, "Sandwich"], [2564, "Siasconset"], [2565, "Silver Beach"], [2568, "Vineyard Haven"], [2571, "Wareham"], [2573, "West Chop"], [2574, "West Falmouth"], [2575, "West Tisbury"], [2576, "West Wareham"], [2584, "Nantucket"], [2601, "Hyannis"], [2630, "Barnstable"], [2631, "Brewster"], [2632, "Centerville"], [2633, "Chatham"], [2634, "Centerville"], [2635, "Cotuit"], [2636, "Centerville"], [2637, "Cummaquid"], [2638, "Dennis"], [2639, "Dennis Port"], [2641, "East Dennis"], [2642, "Eastham"], [2643, "East Orleans"], [2644, "Forestdale"], [2645, "Harwich"], [2646, "Harwich Port"], [2647, "Hyannis Port"], [2648, "Marstons Mills"], [2649, "Mashpee"], [2650, "North Chatham"], [2651, "North Eastham"], [2652, "North Truro"], [2653, "Orleans"], [2655, "Osterville"], [2657, "Provincetown"], [2659, "South Chatham"], [2660, "South Dennis"], [2661, "South Harwich"], [2662, "South Orleans"], [2663, "South Wellfleet"], [2664, "South Yarmouth"], [2666, "Truro"], [2667, "Wellfleet"], [2668, "West Barnstable"], [2669, "West Chatham"], [2670, "West Dennis"], [2671, "West Harwich"], [2672, "West Hyannisport"], [2673, "West Yarmouth"], [2675, "Yarmouth Port"], [2702, "Assonet"], [2703, "Attleboro"], [2712, "Chartley"], [2713, "Cuttyhunk"], [2714, "Dartmouth"], [2715, "Dighton"], [2717, "East Freetown"], [2718, "East Taunton"], [2719, "Fairhaven"], [2720, "Fall River"], [2721, "Fall River"], [2722, "Fall River"], [2723, "Fall River"], [2724, "Fall River"], [2725, "Somerset"], [2726, "Somerset"], [2738, "Marion"], [2739, "Mattapoisett"], [2740, "New Bedford"], [2741, "New Bedford"], [2742, "New Bedford"], [2743, "Acushnet"], [2744, "New Bedford"], [2745, "New Bedford"], [2746, "New Bedford"], [2747, "North Dartmouth"], [2748, "South Dartmouth"], [2760, "North Attleboro"], [2761, "North Attleboro"], [2762, "Plainville"], [2763, "Attleboro Falls"], [2764, "North Dighton"], [2766, "Norton"], [2767, "Raynham"], [2768, "Raynham Center"], [2769, "Rehoboth"], [2770, "Rochester"], [2771, "Seekonk"], [2777, "Swansea"], [2779, "Berkley"], [2780, "Taunton"], [2783, "Taunton"], [2790, "Westport"], [2791, "Westport Point"], [5501, "Andover"], [5544, "Andover"]];


   </script>

  </head>
  <body>
    <div id="container">
      <div class="pagetitle">
        <h1>Postcard Entry Form</h1>
      </div>
      <div class="row" id="main">
        <div class="column">
          <label class="required-field" >required field  </label><br /> 
          <label for="zipcode" class="required-field" >zipcode</label>
          <input style="margin-left: 10px" autofocus autocomplete="off" id="zipcode" onchange="myZip({'xx':'dd'})" type="text" name="zipcode"><br />
          <label for="state" class="required-field" >state</label>
          <input style="margin-left: 31px"  autocomplete="off" id="state" onchange="mvFocus('city')" type="text" name="state"><br />

          <label for="city" class="required-field" >city/town</label>
          <input autocomplete="off" id="city"  onchange="myCity()"type="text" name="city"><br />

          <label for="address" class="required-field" >address</label>
          <input style="margin-left: 12px"  autocomplete="off" id="address" onchange="myLookup()" type="text" name="address">
          <input autocomplete="off" id="suite" onchange="mvFocus('firstName')" type="text" name="suite" placeholder="apt/suite"><br />

          <label for="firstName">name</label> 
          <input style="margin-left: 33px"  autocomplete="off" id="firstName"  onchange="mvFocus('lastName')" type="text" name=" firstName" placeholder="first name">
          <input autocomplete="off" id="lastName"  onchange="mvFocus('email')" type="text" name="lastName" placeholder="last name"><br />
          <label for="email">email</label> 
          <input style="margin-left: 32px"  autocomplete="off" id="email"  onchange="mvFocus('phone')" type="text" name="email"><br />
          <label for="phone">phone</label> 
          <input style="margin-left: 28px"  autocomplete="off" id="phone"  type="text" name="phone"><br />
          <br />
          <label for="stateSen">stateSen</label> 
          <input autocomplete="off" id="stateSen"  type="text" name="stateSen">
          <label for="stateRep">stateRep</label>
          <input autocomplete="off" id="stateRep"  type="text" name="stateRep"><br /> 
          <label class="biglabel" for="route">route</label>
          <input style="margin-left: 4px" autocomplete="off" id="route" type="text" name="route" class="bigtext">

          <button class="button " onclick="mySubmit()">Submit</button>
          <button class="button  button1" onclick="myClear()">Clear</button>
        </div>
        <div class="column">
          <h3>Street Guesses</h3>
          <input style="margin-left: 8px"  autocomplete="off" id="guess1"  type="text" name="guess1" onclick="mkGuess(value)"><br />
          <input style="margin-left: 8px"  autocomplete="off" id="guess2"  type="text" name="guess2" onclick="mkGuess(value)"><br />
          <input style="margin-left: 8px"  autocomplete="off" id="guess3"  type="text" name="guess3" onclick="mkGuess(value)"><br />
          <input style="margin-left: 8px"  autocomplete="off" id="guess4"  type="text" name="guess4" onclick="mkGuess(value)"><br />
          <input style="margin-left: 8px"  autocomplete="off" id="guess5"  type="text" name="guess5" onclick="mkGuess(value)"><br />
        </div>
      </div>
      <div>
        <hr>
        <h3>Quick Instructions</h3>
        <ul>
          <li>Enter zipcode first. Massachusetts city/town will autofill</li>
          <li>Non-MA zipcodes will NOT autofill state or city/town</li>
          <li>Enter address next. Massachusetts state senator and representative will autofill</li>
          <li>If Route UNKNOWN, click on closest Street Guess to look up a valid street</li>
          <li>PO boxes, business addresses and invalid MA addresses will not autofill senator and representative </li>
          <li>Hit TAB to skip a field</li>
          <li>BEFORE hitting "Submit", copy the route info onto a sticky and afix it to postcard</li>
          <li>The format of route is "senator_room/representative_room"</li>
          <li>Hit "Submit" to record the form data and clear the form</li>
          <li>Hit "Clear" to clear the form without submitting the data</li>
          <li>TIP: To get route without resubmitting, reenter required fields, wait for autofill and hit "Clear"</li>
        </ul> 
      </div>
    </div>
  </body>
</html>

<script>
var formNames = ['zipcode','state','city','address','suite','firstName','lastName','email','phone','stateSen','stateRep','route','guess1','guess2','guess3','guess4','guess5'];

function mvFocus(next){
  document.getElementById(next).focus();
}

function data2py(msg){
  $.post( "/postmethod", {
    javascript_data: JSON.stringify(msg)
  });
}


function submit(msg){
  $.post( "/submitted", {
    javascript_data: JSON.stringify(msg)
  });
}


function mySheet(){
  var x = document.getElementById("spreadsheet").value;
  $.post( "/gsOpen", {
    javascript_data: JSON.stringify(x)
  });
  document.getElementById("zipcode").focus();
}


//zipcode to town lookup and send to python
function myZip(msg) {
  //console.log(msg['xx']);
  var x = document.getElementById("zipcode").value; //find the town for this zipcode
  for (var i = 0; i < zip2town.length; i++) { 
    if(zip2town[i][0] == parseInt(x)){
      break;
    }
  }
  if(i == zip2town.length){ //out of state 
    document.getElementById("state").value = "";
    document.getElementById("city").value = "";
    document.getElementById("state").focus();
    data2py({'zipcode':x});
  }
  else{
    //console.log(zip2town[i])
    document.getElementById("state").value = "MA";
    document.getElementById("city").value = zip2town[i][1];
    document.getElementById("address").focus();
    data2py({'zipcode':x,'state':'MA','town':zip2town[i][1]});
  }
}


//zipcode to town lookup and send to python
function myCity(msg) {
  //console.log(msg['xx']);
  var x = document.getElementById("city").value; //find the zipcode for this town
  for (var i = 0; i < zip2town.length; i++) { 
    if(zip2town[i][1] == x){
      break;
    }
  }
  if(i == zip2town.length){ //out of state 
    document.getElementById("state").value = "";
    document.getElementById("zipcode").value = "";
    document.getElementById("zipcode").focus();
    data2py({'zipcode':x});
  }
  else{
    var tmp = zip2town[i][0].toString().padStart(5,'0');
    document.getElementById("zipcode").value = tmp
    document.getElementById("state").value = "MA";
    document.getElementById("address").focus();
    data2py({'town':x,'state':'MA','zipcode':tmp});
  }
}


function myLookup() {
  document.getElementById("suite").focus();
  var x = document.getElementById("zipcode").value;
  var y = document.getElementById("city").value;
  var z = document.getElementById("address").value;

  //data2py({'zipcode':x,'town':y,'address':z});
  var msg = {'zipcode':x,'town':y,'address':z};
  $.post( "/postmethod", {javascript_data: JSON.stringify(msg)},
     getSenRep //don't do this function until after the post completes
  );
}

var getSenRep = function(){
  $.get("/getpythondata", function(data) {
    var w = $.parseJSON(data);
    if("route" in w){
      document.getElementById("route").value = w["route"];
      document.getElementById("stateSen").value = w["Senator"];
      document.getElementById("stateRep").value = w["Representative"];
      document.getElementById("guess1").value = "";
      document.getElementById("guess2").value = "";
      document.getElementById("guess3").value = "";
      document.getElementById("guess4").value = "";
      document.getElementById("guess5").value = "";

    }
    else {
      document.getElementById("route").value = "Unknown";
      document.getElementById("stateSen").value = "";
      document.getElementById("stateRep").value = "";
      document.getElementById("guess1").value = w["guesses"][0];
      document.getElementById("guess2").value = w["guesses"][1];
      document.getElementById("guess3").value = w["guesses"][2];
      document.getElementById("guess4").value = w["guesses"][3];
      document.getElementById("guess5").value = w["guesses"][4];
    }
  })
}


function myClear(){
  for (var i = 0; i < formNames.length; i++) { 
    document.getElementById(formNames[i]).value = "";
  }
  document.getElementById("zipcode").focus();
}

function mySubmit(){
  var w = document.getElementById("state").value;
  var x = document.getElementById("zipcode").value;
  var y = document.getElementById("city").value;
  var z = document.getElementById("address").value;
  //if((w == "") || (x == "") || (y == "") || (z == "")){
  if(w == "" || x == "" || z=="" || y ==""){
    alert("required field missing!");
  }
  else {
    var msg = {};
    for (var i = 0; i < formNames.length; i++) { 
      msg[formNames[i]] = document.getElementById(formNames[i]).value;
    }
    console.log(JSON.stringify(msg));
    $.post( "/submitted", {
      javascript_data: JSON.stringify(msg)
    });
    myClear()
  }
}

function mkGuess(guess){
  var x = document.getElementById("address").value;
  var y = x.split(" ",2);
  if(isNaN(y[0])) var z = guess
  else var z = y[0] + " " + guess;
  document.getElementById("address").value = z;
  myLookup();
}


</script>


